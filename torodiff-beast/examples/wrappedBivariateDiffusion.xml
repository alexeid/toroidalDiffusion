<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.pkgmgmt:beast.base.core:beast.base.inference:beast.base.evolution.alignment:beast.base.evolution.tree.coalescent:beast.base.util:beast.base.math:beast.evolution.nuc:beast.base.evolution.operator:beast.base.inference.operator:beast.base.evolution.sitemodel:beast.base.evolution.substitutionmodel:beast.base.evolution.likelihood:beast.base.evolution.speciation" required="BEAST v2.5.0" version="2.5">

    <!-- minordimension = nsite * 2 (angles) -->
    <parameter id="dihedralAngles" keys="t1 t2 t3 t4"
               minordimension="6"
               value=""/>
    <parameter id="internalNodesAngles"
               minordimension="6"
               value=""/>


    <run id="mcmc" spec="MCMC" chainLength="1000000">
        <state id="state" storeEvery="10000">
            <parameter id="lambda" spec="parameter.RealParameter" name="stateNode">0.1</parameter>
        </state>

        <!-- START posterior -->
        <distribution id="posterior" spec="beast.base.inference.CompoundDistribution">

            <!-- START prior -->
            <distribution id="prior" spec="beast.base.inference.CompoundDistribution">

                <distribution id="lambda.prior" spec="distribution.Prior" x="@lambda">
                    <distr id="LogNormalDistributionModel" spec="distribution.LogNormalDistributionModel">
                        <parameter id="RealParameter" spec="parameter.RealParameter" name="M">3.0</parameter>
                        <parameter id="RealParameter1" spec="parameter.RealParameter" name="S">1.0</parameter>
                    </distr>
                </distribution>

            </distribution>
            <!-- END prior -->

            <!-- START likelihood -->
            <distribution id="likelihood" spec="beast.base.inference.CompoundDistribution" useThreads="false">

                <tree id="FixedTree" spec="beast.base.evolution.tree.TreeParser" IsLabelledNewick="true"
                      adjustTipHeights="false"  offset="0" singlechild="false" binarizeMultifurcations="true"
                      newick="(((sp1:1.0,sp2:1.0):1.0,sp3:2.0):1.0,sp4:3.0);">
                    <taxonset id="TaxonSet" spec="TaxonSet">
                        <taxon id="t1" spec="Taxon"/>
                        <taxon id="t2" spec="Taxon"/>
                        <taxon id="t3" spec="Taxon"/>
                        <taxon id="t4" spec="Taxon"/>
                    </taxonset>
                </tree>

                <parameter id="mu" spec="parameter.RealParameter" dimension="2" name="stateNode">2.0 2.5</parameter>
                <parameter id="alpha" spec="parameter.RealParameter" dimension="3" name="stateNode">1.0 1.0 0.5</parameter>
                <parameter id="sigma" spec="parameter.RealParameter" dimension="2" name="stateNode">0.5 0.75</parameter>


            </distribution> <!-- END Likelihood -->
        </distribution> <!-- END Posterior -->


        <logger id="tracelog" fileName="WBD_fixedtree.log" logEvery="10000" model="@posterior" sanitiseHeaders="true" sort="smart">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>

        </logger>

        <logger id="screenlog" logEvery="100000">
            <log idref="posterior"/>
            <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
        </logger>

<!--        <logger id="treelog.t:firsthalf" fileName="WBD_fixedtree.trees" logEvery="5000" mode="tree">-->
<!--            <log id="TreeWithMetaDataLogger" spec="beast.base.evolution.tree.TreeWithMetaDataLogger" tree="@FixedTree"/>-->
<!--        </logger>-->
    </run>
</beast>